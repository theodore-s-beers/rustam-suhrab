import{t as D,a as S,c as he}from"../chunks/CWAYeBTa.js";import{x as oe,b as ue,s as U,h as k,q as me,a as le,A as u,a3 as de,c as ce,r as G,d as V,g as M,Z as fe,e as te,f as ae,p as be,a4 as Y,a1 as se,w as K,a5 as z,a6 as ve,a7 as J,a8 as ge,a9 as Ne,a0 as pe,aa as xe,k as _e,ab as we,ac as Te,W as ye,S as ke,ad as Oe,ae as Pe,af as We,G as Ee,ag as q,ah as X,I as Z,m as w,J as $,K as Le,ai as R,aj as Ae,ak as Ie,L as P,o as _,al as F}from"../chunks/C9rBuFmc.js";import{d as Se,h as Me,e as $e,s as W}from"../chunks/Chg_53D_.js";import{i as Q}from"../chunks/mfL5n9QS.js";import{o as Ce}from"../chunks/BX2jUikl.js";function Re(e,t,a,n){for(var m=[],o=t.length,d=0;d<o;d++)Ne(t[d].e,m,!0);var N=o>0&&m.length===0&&a!==null;if(N){var p=a.parentNode;pe(p),p.append(a),n.clear(),L(e,t[0].prev,t[o-1].next)}xe(m,()=>{for(var b=0;b<o;b++){var r=t[b];N||(n.delete(r.k),L(e,r.prev,r.next)),_e(r.e,!N)}})}function De(e,t,a,n,m,o=null){var d=e,N={flags:t,items:new Map,first:null};{var p=e;d=k?U(me(p)):p.appendChild(oe())}k&&le();var b=null,r=!1,x=de(()=>{var h=a();return ke(h)?h:h==null?[]:se(h)});ue(()=>{var h=u(x),i=h.length;if(r&&i===0)return;r=i===0;let s=!1;if(k){var T=d.data===ce;T!==(i===0)&&(d=G(),U(d),V(!1),s=!0)}if(k){for(var v=null,l,c=0;c<i;c++){if(M.nodeType===8&&M.data===fe){d=M,s=!0,V(!1);break}var E=h[c],g=n(E,c);l=ie(M,N,v,null,E,g,c,m,t,a),N.items.set(g,l),v=l}i>0&&U(G())}k||He(h,N,d,m,t,n,a),o!==null&&(i===0?b?te(b):b=ae(()=>o(d)):b!==null&&be(b,()=>{b=null})),s&&V(!0),u(x)}),k&&(d=M)}function He(e,t,a,n,m,o,d){var N=e.length,p=t.items,b=t.first,r=b,x,h=null,i=[],s=[],T,v,l,c;for(c=0;c<N;c+=1){if(T=e[c],v=o(T,c),l=p.get(v),l===void 0){var E=r?r.e.nodes_start:a;h=ie(E,t,h,h===null?t.first:h.next,T,v,c,n,m,d),p.set(v,h),i=[],s=[],r=h.next;continue}if(Ue(l,T,c),(l.e.f&Y)!==0&&te(l.e),l!==r){if(x!==void 0&&x.has(l)){if(i.length<s.length){var g=s[0],f;h=g.prev;var y=i[0],A=i[i.length-1];for(f=0;f<i.length;f+=1)j(i[f],g,a);for(f=0;f<s.length;f+=1)x.delete(s[f]);L(t,y.prev,A.next),L(t,h,y),L(t,A,g),r=g,h=A,c-=1,i=[],s=[]}else x.delete(l),j(l,r,a),L(t,l.prev,l.next),L(t,l,h===null?t.first:h.next),L(t,h,l),h=l;continue}for(i=[],s=[];r!==null&&r.k!==v;)(r.e.f&Y)===0&&(x??(x=new Set)).add(r),s.push(r),r=r.next;if(r===null)continue;l=r}i.push(l),h=l,r=l.next}if(r!==null||x!==void 0){for(var O=x===void 0?[]:se(x);r!==null;)(r.e.f&Y)===0&&O.push(r),r=r.next;var H=O.length;if(H>0){var I=N===0?a:null;Re(t,O,I,p)}}K.first=t.first&&t.first.e,K.last=h&&h.e}function Ue(e,t,a,n){z(e.v,t),z(e.i,a)}function ie(e,t,a,n,m,o,d,N,p,b){var r=(p&we)!==0,x=(p&Te)===0,h=r?x?ve(m):J(m):m,i=(p&ge)===0?d:J(d),s={i,v:h,k:o,a:null,e:null,prev:a,next:n};try{return s.e=ae(()=>N(e,h,i,b),k),s.e.prev=a&&a.e,s.e.next=n&&n.e,a===null?t.first=s:(a.next=s,a.e.next=s.e),n!==null&&(n.prev=s,n.e.prev=s.e),s}finally{}}function j(e,t,a){for(var n=e.next?e.next.e.nodes_start:a,m=t?t.e.nodes_start:a,o=e.e.nodes_start;o!==n;){var d=ye(o);m.before(o),o=d}}function L(e,t,a){t===null?e.first=a:(t.next=a,t.e.next=a&&a.e),a!==null&&(a.prev=t,a.e.prev=t&&t.e)}function Ve(e,t){return e==null?null:String(e)}function Ye(e,t,a,n){var m=e.__style;if(k||m!==t){var o=Ve(t);(!k||o!==e.getAttribute("style"))&&(o==null?e.removeAttribute("style"):e.style.cssText=o),e.__style=t}return n}const qe=Symbol("is custom element"),Be=Symbol("is html");function Ge(e,t,a,n){var m=Ke(e);k&&(m[t]=e.getAttribute(t),e.nodeName==="LINK")||m[t]!==(m[t]=a)&&(a==null?e.removeAttribute(t):typeof a!="string"&&ze(e).includes(t)?e[t]=a:e.setAttribute(t,a))}function Ke(e){return e.__attributes??(e.__attributes={[qe]:e.nodeName.includes("-"),[Be]:e.namespaceURI===Oe})}var ee=new Map;function ze(e){var t=ee.get(e.nodeName);if(t)return t;ee.set(e.nodeName,t=[]);for(var a,n=e,m=Element.prototype;m!==n;){a=We(n);for(var o in a)a[o].set&&t.push(o);n=Pe(n)}return t}const Je=[{volumeNumber:2,pageNumber:117,editor:"tsb",heading:!0,headingText:"داستان رستم و سهراب",numberWithinPage:1,hemistichOne:{},hemistichTwo:{}},{volumeNumber:2,pageNumber:117,editor:"tsb",heading:!1,numberWithinPage:2,hemistichOne:{text:"اگر تندبادی برآید ز کنج",hasNotes:!1},hemistichTwo:{text:"به خاک افگند نارسیده ترنج",hasNotes:!0}},{volumeNumber:2,pageNumber:117,editor:"tsb",heading:!1,numberWithinPage:3,hemistichOne:{text:"ستمگاره خوانیمش ار دادگر",hasNotes:!0},hemistichTwo:{text:"هنرمند گوییمش ار بی‌هنر",hasNotes:!0}},{volumeNumber:2,pageNumber:117,editor:"tsb",heading:!1,numberWithinPage:4,hemistichOne:{text:"اگر مرگ دادست بیداد چیست",hasNotes:!1},hemistichTwo:{text:"ز داد این همه بانگ و فریاد چیست",hasNotes:!0}},{volumeNumber:2,pageNumber:117,editor:"tsb",heading:!1,numberWithinPage:5,hemistichOne:{text:"ازین راز جان تو آگاه نیست",hasNotes:!1},hemistichTwo:{text:"بدین پرده اندر ترا راه نیست",hasNotes:!0}},{volumeNumber:2,pageNumber:117,editor:"tsb",heading:!1,numberWithinPage:6,numberListed:5,hemistichOne:{text:"همه تا در آز رفته فراز",hasNotes:!1},hemistichTwo:{text:"به کس بر نشد این در راز باز",hasNotes:!0}},{volumeNumber:2,pageNumber:118,editor:"tsb",heading:!1,numberWithinPage:1,hemistichOne:{text:"به رفتن مگر بهتر آیدت جای",hasNotes:!0},hemistichTwo:{text:"چو آرام گیری به دیگر سرای",hasNotes:!0}},{volumeNumber:2,pageNumber:118,editor:"tsb",heading:!0,headingText:"آغاز داستان",numberWithinPage:2,hemistichOne:{},hemistichTwo:{}},{volumeNumber:2,pageNumber:118,editor:"tsb",heading:!1,numberWithinPage:3,hemistichOne:{text:"ز گفتار دهقان یکی داستان",hasNotes:!1},hemistichTwo:{text:"بپیوندم از گفتهٔ باستان",hasNotes:!0}},{volumeNumber:2,pageNumber:119,editor:"tsb",heading:!1,numberWithinPage:1,hemistichOne:{text:"ز موبد برین گونه برداشت یاد",hasNotes:!0},hemistichTwo:{text:"که یک روز رستم هم از بامداد",hasNotes:!0}},{volumeNumber:2,pageNumber:119,editor:"tsb",heading:!1,numberWithinPage:2,hemistichOne:{text:"غمی بد دلش ساز نخچیر کرد",hasNotes:!0},hemistichTwo:{text:"کمر بست و ترکش پر از تیر کرد",hasNotes:!1}},{volumeNumber:2,pageNumber:119,editor:"tsb",heading:!1,numberWithinPage:3,numberListed:10,hemistichOne:{text:"چو نزدیکی مرز توران رسید",hasNotes:!0},hemistichTwo:{text:"بیابان سراسر پر از گور دید",hasNotes:!1}},{volumeNumber:2,pageNumber:119,editor:"tsb",heading:!1,numberWithinPage:4,hemistichOne:{text:"برافروخت چون گل رخ تاج‌بخش",hasNotes:!1},hemistichTwo:{text:"بخندید و ز جای برکند رخش",hasNotes:!0}},{volumeNumber:2,pageNumber:119,editor:"tsb",heading:!1,numberWithinPage:5,hemistichOne:{text:"به تیر و کمان و به گرز و کمند",hasNotes:!1},hemistichTwo:{text:"بیفگند بر دشت نخچیر چند",hasNotes:!0}},{volumeNumber:2,pageNumber:119,editor:"tsb",heading:!1,numberWithinPage:6,hemistichOne:{text:"ز خاشاک و از خار و شاخ درخت",hasNotes:!0},hemistichTwo:{text:"یکی آتشی برفروزید سخت",hasNotes:!1}},{volumeNumber:2,pageNumber:119,editor:"tsb",heading:!1,numberWithinPage:7,hemistichOne:{text:"چو آتش پراگنده شد پیلتن",hasNotes:!1},hemistichTwo:{text:"درختی بجست از در بابزن",hasNotes:!0}},{volumeNumber:2,pageNumber:119,editor:"tsb",heading:!1,numberWithinPage:8,numberListed:15,hemistichOne:{text:"یکی ترّه‌گوری بزد بر درخت",hasNotes:!1},hemistichTwo:{text:"که در چنگ او پرّ مرغی نسخت",hasNotes:!0}},{volumeNumber:2,pageNumber:119,editor:"tsb",heading:!1,numberWithinPage:9,hemistichOne:{text:"چو بریان شد از هم بکند و بخورد",hasNotes:!1},hemistichTwo:{text:"ز مغر استخوانش برآورد گرد",hasNotes:!1}},{volumeNumber:2,pageNumber:119,editor:"tsb",heading:!1,numberWithinPage:10,hemistichOne:{text:"بخفت و برآسود از روزگار",hasNotes:!1},hemistichTwo:{text:"چمان و چران رخش در مرغزار",hasNotes:!0}},{volumeNumber:2,pageNumber:119,editor:"tsb",heading:!1,numberWithinPage:11,hemistichOne:{text:"سواران ترکان تنی هفت هشت",hasNotes:!0},hemistichTwo:{text:"بر آن دشت نخچیرگان برگذشت",hasNotes:!0}},{volumeNumber:2,pageNumber:119,editor:"tsb",heading:!1,numberWithinPage:12,hemistichOne:{text:"پی اسپ دیدند در مرغزار",hasNotes:!0},hemistichTwo:{text:"بگشتند گرد لب جویبار",hasNotes:!0}},{volumeNumber:2,pageNumber:119,editor:"tsb",heading:!1,numberWithinPage:13,numberListed:20,hemistichOne:{text:"چو بر دشت مر رخش را یافتند",hasNotes:!0},hemistichTwo:{text:"سوی بند کردنش بشتافتند",hasNotes:!1}},{volumeNumber:2,pageNumber:120,editor:"tsb",heading:!1,numberWithinPage:1,hemistichOne:{text:"گرفتند و بردند پویان به شهر",hasNotes:!0},hemistichTwo:{text:"همی هر یک از رخش جستند بهر",hasNotes:!0}},{volumeNumber:2,pageNumber:120,editor:"tsb",heading:!1,numberWithinPage:2,hemistichOne:{text:"چو بیدار شد رستم از خواب خوش",hasNotes:!1},hemistichTwo:{text:"به کار آمدش بارهٔ دست‌کش",hasNotes:!0}},{volumeNumber:2,pageNumber:120,editor:"tsb",heading:!1,numberWithinPage:3,hemistichOne:{text:"غمی گشت چون بارگی را نیافت",hasNotes:!0},hemistichTwo:{text:"سراسیمه سوی سمنگان شتافت",hasNotes:!1}},{volumeNumber:2,pageNumber:120,editor:"tsb",heading:!1,numberWithinPage:4,hemistichOne:{text:"همی گفت کاکنون پیاده نوان",hasNotes:!0},hemistichTwo:{text:"کجا پویم از ننگ تیره‌روان",hasNotes:!0}},{volumeNumber:2,pageNumber:120,editor:"tsb",heading:!1,numberWithinPage:5,numberListed:25,hemistichOne:{text:"ابا ترکش و گرز بسته میان",hasNotes:!1},hemistichTwo:{text:"چنین ترگ و شمشیر و ببر بیان",hasNotes:!0}},{volumeNumber:2,pageNumber:120,editor:"tsb",heading:!1,numberWithinPage:6,hemistichOne:{text:"چه گویند گردان که اسپش که برد",hasNotes:!0},hemistichTwo:{text:"تهمتن بدانجا بخفت ار بمرد",hasNotes:!0}},{volumeNumber:2,pageNumber:120,editor:"tsb",heading:!1,numberWithinPage:7,hemistichOne:{text:"کنون رفت باید به بیچارگی",hasNotes:!1},hemistichTwo:{text:"به غم دل سپردن به یکبارگی",hasNotes:!0}},{volumeNumber:2,pageNumber:120,editor:"tsb",heading:!1,numberWithinPage:8,hemistichOne:{text:"همی بست باید سلیح و کمر",hasNotes:!0},hemistichTwo:{text:"به جایی نشانش بیابم مگر",hasNotes:!0}},{volumeNumber:2,pageNumber:120,editor:"tsb",heading:!1,numberWithinPage:9,hemistichOne:{text:"چو نزدیک شهر سمنگان رسید",hasNotes:!1},hemistichTwo:{text:"خبر زو به شیر و پلنگان رسید",hasNotes:!0}},{volumeNumber:2,pageNumber:120,editor:"tsb",heading:!1,numberWithinPage:10,numberListed:30,hemistichOne:{text:"که آمد پیاده گو تاج‌بخش",hasNotes:!1},hemistichTwo:{text:"به نخچیرگه زو رمیده‌ست رخش",hasNotes:!1}},{volumeNumber:2,pageNumber:120,editor:"tsb",heading:!1,numberWithinPage:11,hemistichOne:{text:"پذیره شدندش بزرگان و شاه",hasNotes:!1},hemistichTwo:{text:"کسی کو به سر برنهادی کلاه",hasNotes:!0}},{volumeNumber:2,pageNumber:120,editor:"tsb",heading:!1,numberWithinPage:12,hemistichOne:{text:"همی گفت هر کس که این رستم است",hasNotes:!0},hemistichTwo:{text:"وگر آفتاب سپیده‌دم است",hasNotes:!0}},{volumeNumber:2,pageNumber:120,editor:"tsb",heading:!1,numberWithinPage:13,hemistichOne:{text:"بدو گفت شاه سمنگان چه بود",hasNotes:!0},hemistichTwo:{text:"که یارست با تو نبرد آزمود",hasNotes:!0}},{volumeNumber:2,pageNumber:120,editor:"tsb",heading:!1,numberWithinPage:14,hemistichOne:{text:"بدین شهر ما نیک‌خواه تویم",hasNotes:!0},hemistichTwo:{text:"ستوده به فرمان و راه تویم",hasNotes:!0}},{volumeNumber:2,pageNumber:120,editor:"tsb",heading:!1,numberWithinPage:15,numberListed:35,hemistichOne:{text:"تن و خواسته زیر فرمان تست",hasNotes:!1},hemistichTwo:{text:"سر ارجمندان و جان آن تست",hasNotes:!0}},{volumeNumber:2,pageNumber:120,editor:"tsb",heading:!1,numberWithinPage:16,hemistichOne:{text:"چو رستم به گفتار او بنگرید",hasNotes:!0},hemistichTwo:{text:"ز بدها گمانیش کوتاه دید",hasNotes:!1}},{volumeNumber:2,pageNumber:120,editor:"tsb",heading:!1,numberWithinPage:17,hemistichOne:{text:"بدو گفت رخشم بدین مرغزار",hasNotes:!1},hemistichTwo:{text:"ز من دور شد بی لگام و فسار",hasNotes:!0}}];var Xe=D('<div role="tooltip" class="absolute z-10 w-64 -translate-x-1/2 rounded-md border border-gray-600 bg-gray-200 px-2.5 py-2 font-sans text-sm"><div class="mb-1">Vol. <code class="text-pink-800"> </code>, pg. <code class="text-pink-800"> </code>, line <code class="text-pink-800"> </code> (relative)</div> <div class="flex"><a target="_blank" rel="noreferrer" class="text-blue-800 hover:underline">View page image</a> <span class="ml-auto italic">Esc to clear</span></div></div>'),Ze=(e,t,a)=>t(e,u(a)[0]),Fe=(e,t,a)=>{(e.key==="Enter"||e.key===" ")&&(e.preventDefault(),t(e,u(a)[0]))},Qe=(e,t,a)=>t(e,u(a)),je=(e,t,a)=>{(e.key==="Enter"||e.key===" ")&&(e.preventDefault(),t(e,u(a)))},et=D('<div role="button" tabindex="0" class="mt-4 mr-10 mb-6 text-3xl"> </div>'),tt=(e,t,a)=>t(e,u(a)),at=(e,t,a)=>{(e.key==="Enter"||e.key===" ")&&(e.preventDefault(),t(e,u(a)))},st=(e,t,a)=>t(e,u(a)),it=(e,t,a)=>{(e.key==="Enter"||e.key===" ")&&(e.preventDefault(),t(e,u(a)))},rt=D('<div class="flex gap-2"><div class="w-12"> </div> <div role="button" tabindex="0" class="ml-14 w-64 font-medium [text-align-last:justify]"> </div> <div role="button" tabindex="0" class="w-64 font-medium [text-align-last:justify]"> </div> <div class="w-2 text-left text-xs text-green-700"> </div></div>'),nt=D('<!> <div class="flex justify-center"><div role="button" tabindex="0" class="mr-10 mb-8 text-4xl"> </div></div> <div dir="rtl" lang="fa" class="flex flex-col place-items-center gap-4 text-lg"></div>',1);function dt(e,t){Ee(t,!0);let a=q(X(Je)),n=q(null),m=q(X({top:0,left:0}));function o(i,s){const v=i.currentTarget.getBoundingClientRect();R(m,{top:v.bottom+window.scrollY+6,left:window.innerWidth/2-24},!0),R(n,u(n)===s?null:s,!0)}Ce(async()=>{const i=new URLSearchParams;i.append("start-vol","2"),i.append("start-pg","117"),i.append("start-line","1"),i.append("end-vol","2"),i.append("end-pg","199"),i.append("end-line","5"),i.append("editor","tsb");try{const s=await fetch(`https://shahnama-transcription.pages.dev/api/transcribed-lines?${i.toString()}`);if(!s.ok)throw new Error(`${s.status}; ${await s.text()}`);R(a,await s.json(),!0)}catch(s){s instanceof Error?console.error("Error fetching data:",s.message):console.error("Unexpected error:",s)}});var d=nt();Me(i=>{$(()=>Ae.title=u(a)[0].headingText)}),$e("keydown",Ie,i=>{if(i.key==="Escape"){R(n,null);const s=document.activeElement;s instanceof HTMLElement&&s.blur()}});var N=Z(d);{var p=i=>{var s=Xe(),T=w(s),v=P(w(T)),l=w(v,!0);_(v);var c=P(v,2),E=w(c,!0);_(c);var g=P(c,2),f=w(g,!0);_(g),F(),_(T);var y=P(T,2),A=w(y);F(2),_(y),_(s),$(()=>{Ye(s,`top: ${u(m).top??""}px; left: ${u(m).left??""}px`),W(l,u(n).volumeNumber),W(E,u(n).pageNumber),W(f,u(n).numberWithinPage),Ge(A,"href",`https://read.akvan.dev/km/${u(n).volumeNumber??""}/${u(n).pageNumber??""}`)}),S(i,s)};Q(N,i=>{u(n)&&i(p)})}var b=P(N,2),r=w(b);r.__click=[Ze,o,a],r.__keydown=[Fe,o,a];var x=w(r,!0);_(r),_(b);var h=P(b,2);De(h,23,()=>u(a),i=>`${i.volumeNumber}-${i.pageNumber}-${i.numberWithinPage}`,(i,s,T)=>{var v=he(),l=Z(v);{var c=g=>{var f=et();f.__click=[Qe,o,s],f.__keydown=[je,o,s];var y=w(f,!0);_(f),$(()=>W(y,u(s).headingText)),S(g,f)},E=g=>{var f=rt(),y=w(f),A=w(y,!0);_(y);var O=P(y,2);O.__click=[tt,o,s],O.__keydown=[at,o,s];var H=w(O,!0);_(O);var I=P(O,2);I.__click=[st,o,s],I.__keydown=[it,o,s];var re=w(I,!0);_(I);var B=P(I,2),ne=w(B,!0);_(B),_(f),$(C=>{W(A,C),W(H,u(s).hemistichOne.text),W(re,u(s).hemistichTwo.text),W(ne,u(s).hemistichOne.hasNotes||u(s).hemistichTwo.hasNotes?"پ":"")},[()=>{var C;return(C=u(s).numberListed)==null?void 0:C.toLocaleString("fa",{useGrouping:!1})}]),S(g,f)};Q(l,g=>{u(s).heading&&u(T)!==0?g(c):g(E,!1)})}S(i,v)}),_(h),$(()=>{W(x,u(a)[0].headingText),h.dir=h.dir}),S(e,d),Le()}Se(["click","keydown"]);export{dt as component};
