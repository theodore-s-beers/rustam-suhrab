import{t as U,a as I,c as ue}from"../chunks/CWAYeBTa.js";import{x as me,b as le,s as V,h as P,q as de,a as ce,A as u,a3 as be,c as fe,r as G,d as Y,g as S,Z as ve,e as se,f as ie,p as ge,a4 as q,a1 as re,w as J,a5 as X,a6 as Ne,a7 as Z,a8 as pe,a9 as xe,a0 as _e,aa as we,k as Te,ab as ye,ac as ke,W as Oe,S as Pe,ad as We,ae as Ee,af as Le,G as Ae,ag as B,ah as F,I as Q,m as w,J as M,K as Ie,ai as H,aj as Se,ak as Me,L as k,o as N,al as j}from"../chunks/C9rBuFmc.js";import{d as $e,h as Ce,e as Re,s as O}from"../chunks/Chg_53D_.js";import{i as ee}from"../chunks/mfL5n9QS.js";import{o as De}from"../chunks/BX2jUikl.js";function He(e,t,a,n){for(var m=[],o=t.length,d=0;d<o;d++)xe(t[d].e,m,!0);var p=o>0&&m.length===0&&a!==null;if(p){var x=a.parentNode;_e(x),x.append(a),n.clear(),L(e,t[0].prev,t[o-1].next)}we(m,()=>{for(var f=0;f<o;f++){var r=t[f];p||(n.delete(r.k),L(e,r.prev,r.next)),Te(r.e,!p)}})}function Ue(e,t,a,n,m,o=null){var d=e,p={flags:t,items:new Map,first:null};{var x=e;d=P?V(de(x)):x.appendChild(me())}P&&ce();var f=null,r=!1,_=be(()=>{var h=a();return Pe(h)?h:h==null?[]:re(h)});le(()=>{var h=u(_),i=h.length;if(r&&i===0)return;r=i===0;let s=!1;if(P){var T=d.data===fe;T!==(i===0)&&(d=G(),V(d),Y(!1),s=!0)}if(P){for(var v=null,l,c=0;c<i;c++){if(S.nodeType===8&&S.data===ve){d=S,s=!0,Y(!1);break}var E=h[c],g=n(E,c);l=ne(S,p,v,null,E,g,c,m,t,a),p.items.set(g,l),v=l}i>0&&V(G())}P||Ve(h,p,d,m,t,n,a),o!==null&&(i===0?f?se(f):f=ie(()=>o(d)):f!==null&&ge(f,()=>{f=null})),s&&Y(!0),u(_)}),P&&(d=S)}function Ve(e,t,a,n,m,o,d){var p=e.length,x=t.items,f=t.first,r=f,_,h=null,i=[],s=[],T,v,l,c;for(c=0;c<p;c+=1){if(T=e[c],v=o(T,c),l=x.get(v),l===void 0){var E=r?r.e.nodes_start:a;h=ne(E,t,h,h===null?t.first:h.next,T,v,c,n,m,d),x.set(v,h),i=[],s=[],r=h.next;continue}if(Ye(l,T,c),(l.e.f&q)!==0&&se(l.e),l!==r){if(_!==void 0&&_.has(l)){if(i.length<s.length){var g=s[0],b;h=g.prev;var y=i[0],A=i[i.length-1];for(b=0;b<i.length;b+=1)te(i[b],g,a);for(b=0;b<s.length;b+=1)_.delete(s[b]);L(t,y.prev,A.next),L(t,h,y),L(t,A,g),r=g,h=A,c-=1,i=[],s=[]}else _.delete(l),te(l,r,a),L(t,l.prev,l.next),L(t,l,h===null?t.first:h.next),L(t,h,l),h=l;continue}for(i=[],s=[];r!==null&&r.k!==v;)(r.e.f&q)===0&&(_??(_=new Set)).add(r),s.push(r),r=r.next;if(r===null)continue;l=r}i.push(l),h=l,r=l.next}if(r!==null||_!==void 0){for(var W=_===void 0?[]:re(_);r!==null;)(r.e.f&q)===0&&W.push(r),r=r.next;var $=W.length;if($>0){var C=p===0?a:null;He(t,W,C,x)}}J.first=t.first&&t.first.e,J.last=h&&h.e}function Ye(e,t,a,n){X(e.v,t),X(e.i,a)}function ne(e,t,a,n,m,o,d,p,x,f){var r=(x&ye)!==0,_=(x&ke)===0,h=r?_?Ne(m):Z(m):m,i=(x&pe)===0?d:Z(d),s={i,v:h,k:o,a:null,e:null,prev:a,next:n};try{return s.e=ie(()=>p(e,h,i,f),P),s.e.prev=a&&a.e,s.e.next=n&&n.e,a===null?t.first=s:(a.next=s,a.e.next=s.e),n!==null&&(n.prev=s,n.e.prev=s.e),s}finally{}}function te(e,t,a){for(var n=e.next?e.next.e.nodes_start:a,m=t?t.e.nodes_start:a,o=e.e.nodes_start;o!==n;){var d=Oe(o);m.before(o),o=d}}function L(e,t,a){t===null?e.first=a:(t.next=a,t.e.next=a&&a.e),a!==null&&(a.prev=t,a.e.prev=t&&t.e)}function qe(e,t){return e==null?null:String(e)}function Be(e,t,a,n){var m=e.__style;if(P||m!==t){var o=qe(t);(!P||o!==e.getAttribute("style"))&&(o==null?e.removeAttribute("style"):e.style.cssText=o),e.__style=t}return n}const Ke=Symbol("is custom element"),ze=Symbol("is html");function Ge(e,t,a,n){var m=Je(e);P&&(m[t]=e.getAttribute(t),e.nodeName==="LINK")||m[t]!==(m[t]=a)&&(a==null?e.removeAttribute(t):typeof a!="string"&&Xe(e).includes(t)?e[t]=a:e.setAttribute(t,a))}function Je(e){return e.__attributes??(e.__attributes={[Ke]:e.nodeName.includes("-"),[ze]:e.namespaceURI===We})}var ae=new Map;function Xe(e){var t=ae.get(e.nodeName);if(t)return t;ae.set(e.nodeName,t=[]);for(var a,n=e,m=Element.prototype;m!==n;){a=Le(n);for(var o in a)a[o].set&&t.push(o);n=Ee(n)}return t}const Ze=[{volumeNumber:2,pageNumber:117,editor:"tsb",heading:!0,headingText:"داستان رستم و سهراب",numberWithinPage:1,hemistichOne:{},hemistichTwo:{}},{volumeNumber:2,pageNumber:117,editor:"tsb",heading:!1,numberWithinPage:2,hemistichOne:{text:"اگر تندبادی برآید ز کنج",hasNotes:!1},hemistichTwo:{text:"به خاک افگند نارسیده ترنج",hasNotes:!0}},{volumeNumber:2,pageNumber:117,editor:"tsb",heading:!1,numberWithinPage:3,hemistichOne:{text:"ستمگاره خوانیمش ار دادگر",hasNotes:!0},hemistichTwo:{text:"هنرمند گوییمش ار بی‌هنر",hasNotes:!0}},{volumeNumber:2,pageNumber:117,editor:"tsb",heading:!1,numberWithinPage:4,hemistichOne:{text:"اگر مرگ دادست بیداد چیست",hasNotes:!1},hemistichTwo:{text:"ز داد این همه بانگ و فریاد چیست",hasNotes:!0}},{volumeNumber:2,pageNumber:117,editor:"tsb",heading:!1,numberWithinPage:5,hemistichOne:{text:"ازین راز جان تو آگاه نیست",hasNotes:!1},hemistichTwo:{text:"بدین پرده اندر ترا راه نیست",hasNotes:!0}},{volumeNumber:2,pageNumber:117,editor:"tsb",heading:!1,numberWithinPage:6,numberListed:5,hemistichOne:{text:"همه تا در آز رفته فراز",hasNotes:!1},hemistichTwo:{text:"به کس بر نشد این در راز باز",hasNotes:!0}},{volumeNumber:2,pageNumber:118,editor:"tsb",heading:!1,numberWithinPage:1,hemistichOne:{text:"به رفتن مگر بهتر آیدت جای",hasNotes:!0},hemistichTwo:{text:"چو آرام گیری به دیگر سرای",hasNotes:!0}},{volumeNumber:2,pageNumber:118,editor:"tsb",heading:!0,headingText:"آغاز داستان",numberWithinPage:2,hemistichOne:{},hemistichTwo:{}},{volumeNumber:2,pageNumber:118,editor:"tsb",heading:!1,numberWithinPage:3,hemistichOne:{text:"ز گفتار دهقان یکی داستان",hasNotes:!1},hemistichTwo:{text:"بپیوندم از گفتهٔ باستان",hasNotes:!0}},{volumeNumber:2,pageNumber:119,editor:"tsb",heading:!1,numberWithinPage:1,hemistichOne:{text:"ز موبد برین گونه برداشت یاد",hasNotes:!0},hemistichTwo:{text:"که یک روز رستم هم از بامداد",hasNotes:!0}},{volumeNumber:2,pageNumber:119,editor:"tsb",heading:!1,numberWithinPage:2,hemistichOne:{text:"غمی بد دلش ساز نخچیر کرد",hasNotes:!0},hemistichTwo:{text:"کمر بست و ترکش پر از تیر کرد",hasNotes:!1}},{volumeNumber:2,pageNumber:119,editor:"tsb",heading:!1,numberWithinPage:3,numberListed:10,hemistichOne:{text:"چو نزدیکی مرز توران رسید",hasNotes:!0},hemistichTwo:{text:"بیابان سراسر پر از گور دید",hasNotes:!1}},{volumeNumber:2,pageNumber:119,editor:"tsb",heading:!1,numberWithinPage:4,hemistichOne:{text:"برافروخت چون گل رخ تاج‌بخش",hasNotes:!1},hemistichTwo:{text:"بخندید و ز جای برکند رخش",hasNotes:!0}},{volumeNumber:2,pageNumber:119,editor:"tsb",heading:!1,numberWithinPage:5,hemistichOne:{text:"به تیر و کمان و به گرز و کمند",hasNotes:!1},hemistichTwo:{text:"بیفگند بر دشت نخچیر چند",hasNotes:!0}},{volumeNumber:2,pageNumber:119,editor:"tsb",heading:!1,numberWithinPage:6,hemistichOne:{text:"ز خاشاک و از خار و شاخ درخت",hasNotes:!0},hemistichTwo:{text:"یکی آتشی برفروزید سخت",hasNotes:!1}},{volumeNumber:2,pageNumber:119,editor:"tsb",heading:!1,numberWithinPage:7,hemistichOne:{text:"چو آتش پراگنده شد پیلتن",hasNotes:!1},hemistichTwo:{text:"درختی بجست از در بابزن",hasNotes:!0}},{volumeNumber:2,pageNumber:119,editor:"tsb",heading:!1,numberWithinPage:8,numberListed:15,hemistichOne:{text:"یکی ترّه‌گوری بزد بر درخت",hasNotes:!1},hemistichTwo:{text:"که در چنگ او پرّ مرغی نسخت",hasNotes:!0}},{volumeNumber:2,pageNumber:119,editor:"tsb",heading:!1,numberWithinPage:9,hemistichOne:{text:"چو بریان شد از هم بکند و بخورد",hasNotes:!1},hemistichTwo:{text:"ز مغر استخوانش برآورد گرد",hasNotes:!1}},{volumeNumber:2,pageNumber:119,editor:"tsb",heading:!1,numberWithinPage:10,hemistichOne:{text:"بخفت و برآسود از روزگار",hasNotes:!1},hemistichTwo:{text:"چمان و چران رخش در مرغزار",hasNotes:!0}},{volumeNumber:2,pageNumber:119,editor:"tsb",heading:!1,numberWithinPage:11,hemistichOne:{text:"سواران ترکان تنی هفت هشت",hasNotes:!0},hemistichTwo:{text:"بر آن دشت نخچیرگان برگذشت",hasNotes:!0}},{volumeNumber:2,pageNumber:119,editor:"tsb",heading:!1,numberWithinPage:12,hemistichOne:{text:"پی اسپ دیدند در مرغزار",hasNotes:!0},hemistichTwo:{text:"بگشتند گرد لب جویبار",hasNotes:!0}},{volumeNumber:2,pageNumber:119,editor:"tsb",heading:!1,numberWithinPage:13,numberListed:20,hemistichOne:{text:"چو بر دشت مر رخش را یافتند",hasNotes:!0},hemistichTwo:{text:"سوی بند کردنش بشتافتند",hasNotes:!1}},{volumeNumber:2,pageNumber:120,editor:"tsb",heading:!1,numberWithinPage:1,hemistichOne:{text:"گرفتند و بردند پویان به شهر",hasNotes:!0},hemistichTwo:{text:"همی هر یک از رخش جستند بهر",hasNotes:!0}},{volumeNumber:2,pageNumber:120,editor:"tsb",heading:!1,numberWithinPage:2,hemistichOne:{text:"چو بیدار شد رستم از خواب خوش",hasNotes:!1},hemistichTwo:{text:"به کار آمدش بارهٔ دست‌کش",hasNotes:!0}},{volumeNumber:2,pageNumber:120,editor:"tsb",heading:!1,numberWithinPage:3,hemistichOne:{text:"غمی گشت چون بارگی را نیافت",hasNotes:!0},hemistichTwo:{text:"سراسیمه سوی سمنگان شتافت",hasNotes:!1}},{volumeNumber:2,pageNumber:120,editor:"tsb",heading:!1,numberWithinPage:4,hemistichOne:{text:"همی گفت کاکنون پیاده نوان",hasNotes:!0},hemistichTwo:{text:"کجا پویم از ننگ تیره‌روان",hasNotes:!0}},{volumeNumber:2,pageNumber:120,editor:"tsb",heading:!1,numberWithinPage:5,numberListed:25,hemistichOne:{text:"ابا ترکش و گرز بسته میان",hasNotes:!1},hemistichTwo:{text:"چنین ترگ و شمشیر و ببر بیان",hasNotes:!0}},{volumeNumber:2,pageNumber:120,editor:"tsb",heading:!1,numberWithinPage:6,hemistichOne:{text:"چه گویند گردان که اسپش که برد",hasNotes:!0},hemistichTwo:{text:"تهمتن بدانجا بخفت ار بمرد",hasNotes:!0}},{volumeNumber:2,pageNumber:120,editor:"tsb",heading:!1,numberWithinPage:7,hemistichOne:{text:"کنون رفت باید به بیچارگی",hasNotes:!1},hemistichTwo:{text:"به غم دل سپردن به یکبارگی",hasNotes:!0}},{volumeNumber:2,pageNumber:120,editor:"tsb",heading:!1,numberWithinPage:8,hemistichOne:{text:"همی بست باید سلیح و کمر",hasNotes:!0},hemistichTwo:{text:"به جایی نشانش بیابم مگر",hasNotes:!0}},{volumeNumber:2,pageNumber:120,editor:"tsb",heading:!1,numberWithinPage:9,hemistichOne:{text:"چو نزدیک شهر سمنگان رسید",hasNotes:!1},hemistichTwo:{text:"خبر زو به شیر و پلنگان رسید",hasNotes:!0}},{volumeNumber:2,pageNumber:120,editor:"tsb",heading:!1,numberWithinPage:10,numberListed:30,hemistichOne:{text:"که آمد پیاده گو تاج‌بخش",hasNotes:!1},hemistichTwo:{text:"به نخچیرگه زو رمیده‌ست رخش",hasNotes:!1}},{volumeNumber:2,pageNumber:120,editor:"tsb",heading:!1,numberWithinPage:11,hemistichOne:{text:"پذیره شدندش بزرگان و شاه",hasNotes:!1},hemistichTwo:{text:"کسی کو به سر برنهادی کلاه",hasNotes:!0}},{volumeNumber:2,pageNumber:120,editor:"tsb",heading:!1,numberWithinPage:12,hemistichOne:{text:"همی گفت هر کس که این رستم است",hasNotes:!0},hemistichTwo:{text:"وگر آفتاب سپیده‌دم است",hasNotes:!0}},{volumeNumber:2,pageNumber:120,editor:"tsb",heading:!1,numberWithinPage:13,hemistichOne:{text:"بدو گفت شاه سمنگان چه بود",hasNotes:!0},hemistichTwo:{text:"که یارست با تو نبرد آزمود",hasNotes:!0}},{volumeNumber:2,pageNumber:120,editor:"tsb",heading:!1,numberWithinPage:14,hemistichOne:{text:"بدین شهر ما نیک‌خواه تویم",hasNotes:!0},hemistichTwo:{text:"ستوده به فرمان و راه تویم",hasNotes:!0}},{volumeNumber:2,pageNumber:120,editor:"tsb",heading:!1,numberWithinPage:15,numberListed:35,hemistichOne:{text:"تن و خواسته زیر فرمان تست",hasNotes:!1},hemistichTwo:{text:"سر ارجمندان و جان آن تست",hasNotes:!0}},{volumeNumber:2,pageNumber:120,editor:"tsb",heading:!1,numberWithinPage:16,hemistichOne:{text:"چو رستم به گفتار او بنگرید",hasNotes:!0},hemistichTwo:{text:"ز بدها گمانیش کوتاه دید",hasNotes:!1}},{volumeNumber:2,pageNumber:120,editor:"tsb",heading:!1,numberWithinPage:17,hemistichOne:{text:"بدو گفت رخشم بدین مرغزار",hasNotes:!1},hemistichTwo:{text:"ز من دور شد بی لگام و فسار",hasNotes:!0}}];var Fe=U('<div role="tooltip" class="absolute z-10 w-[17rem] -translate-x-1/2 rounded-md border border-gray-600 bg-gray-200 px-2.5 py-2 text-sm"><div class="mb-1">Vol. <code class="text-pink-800"> </code>, pg. <code class="text-pink-800"> </code>, line <code class="text-pink-800"> </code> (relative)</div> <div class="flex"><a target="_blank" rel="noreferrer" class="text-blue-800 hover:underline">View page image</a> <span class="ml-auto italic">Esc to clear</span></div></div>'),Qe=(e,t,a)=>t(e,u(a)[0]),je=(e,t,a)=>{(e.key==="Enter"||e.key===" ")&&(e.preventDefault(),t(e,u(a)[0]))},et=(e,t,a)=>t(e,u(a)),tt=(e,t,a)=>{(e.key==="Enter"||e.key===" ")&&(e.preventDefault(),t(e,u(a)))},at=U('<div role="button" tabindex="0" class="mt-4 mr-12 mb-6 text-3xl"> </div>'),st=(e,t,a)=>t(e,u(a)),it=(e,t,a)=>{(e.key==="Enter"||e.key===" ")&&(e.preventDefault(),t(e,u(a)))},rt=(e,t,a)=>t(e,u(a)),nt=(e,t,a)=>{(e.key==="Enter"||e.key===" ")&&(e.preventDefault(),t(e,u(a)))},ht=U('<div class="flex gap-2"><div class="w-12"> </div> <div role="button" tabindex="0" class="ml-16 w-[17rem] [text-align-last:justify]"> <span class="text-green-700"> </span></div> <div role="button" tabindex="0" class="w-[17rem] [text-align-last:justify]"> <span class="text-green-700"> </span></div></div>'),ot=U('<!> <div class="flex justify-center"><div role="button" tabindex="0" class="mr-12 mb-8 text-4xl"> </div></div> <div dir="rtl" lang="fa" class="flex flex-col place-items-center gap-4 text-lg"></div>',1);function bt(e,t){Ae(t,!0);let a=B(F(Ze)),n=B(null),m=B(F({top:0,left:0}));function o(i,s){const v=i.currentTarget.getBoundingClientRect();H(m,{top:v.bottom+window.scrollY+6,left:window.innerWidth/2-24},!0),H(n,u(n)===s?null:s,!0)}De(async()=>{const i=new URLSearchParams;i.append("start-vol","2"),i.append("start-pg","117"),i.append("start-line","1"),i.append("end-vol","2"),i.append("end-pg","199"),i.append("end-line","5"),i.append("editor","tsb");try{const s=await fetch(`https://shahnama-transcription.pages.dev/api/transcribed-lines?${i.toString()}`);if(!s.ok)throw new Error(`${s.status}; ${await s.text()}`);H(a,await s.json(),!0)}catch(s){s instanceof Error?console.error("Error fetching data:",s.message):console.error("Unexpected error:",s)}});var d=ot();Ce(i=>{M(()=>Se.title=u(a)[0].headingText)}),Re("keydown",Me,i=>{if(i.key==="Escape"){H(n,null);const s=document.activeElement;s instanceof HTMLElement&&s.blur()}});var p=Q(d);{var x=i=>{var s=Fe(),T=w(s),v=k(w(T)),l=w(v,!0);N(v);var c=k(v,2),E=w(c,!0);N(c);var g=k(c,2),b=w(g,!0);N(g),j(),N(T);var y=k(T,2),A=w(y);j(2),N(y),N(s),M(()=>{Be(s,`top: ${u(m).top??""}px; left: ${u(m).left??""}px`),O(l,u(n).volumeNumber),O(E,u(n).pageNumber),O(b,u(n).numberWithinPage),Ge(A,"href",`https://read.akvan.dev/km/${u(n).volumeNumber??""}/${u(n).pageNumber??""}`)}),I(i,s)};ee(p,i=>{u(n)&&i(x)})}var f=k(p,2),r=w(f);r.__click=[Qe,o,a],r.__keydown=[je,o,a];var _=w(r,!0);N(r),N(f);var h=k(f,2);Ue(h,23,()=>u(a),i=>`${i.volumeNumber}-${i.pageNumber}-${i.numberWithinPage}`,(i,s,T)=>{var v=ue(),l=Q(v);{var c=g=>{var b=at();b.__click=[et,o,s],b.__keydown=[tt,o,s];var y=w(b,!0);N(b),M(()=>O(y,u(s).headingText)),I(g,b)},E=g=>{var b=ht(),y=w(b),A=w(y,!0);N(y);var W=k(y,2);W.__click=[st,o,s],W.__keydown=[it,o,s];var $=w(W,!0),C=k($),he=w(C,!0);N(C),N(W);var R=k(W,2);R.__click=[rt,o,s],R.__keydown=[nt,o,s];var K=w(R,!0),z=k(K),oe=w(z,!0);N(z),N(R),N(b),M(D=>{O(A,D),O($,u(s).hemistichOne.text),O(he,u(s).hemistichOne.hasNotes?"*":""),O(K,u(s).hemistichTwo.text),O(oe,u(s).hemistichTwo.hasNotes?"*":"")},[()=>{var D;return(D=u(s).numberListed)==null?void 0:D.toLocaleString("fa")}]),I(g,b)};ee(l,g=>{u(s).heading&&u(T)!==0?g(c):g(E,!1)})}I(i,v)}),N(h),M(()=>{O(_,u(a)[0].headingText),h.dir=h.dir}),I(e,d),Ie()}$e(["click","keydown"]);export{bt as component};
